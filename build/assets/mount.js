(function(){if(!customElements.get("triplomat-widget")){class s extends HTMLElement{constructor(){super()}}customElements.define("triplomat-widget",s)}function p(s,{theme:d="standard",lightMode:u=!0,url:l="http://127.0.0.1:8000/widget"}={}){const a=document.createElement("triplomat-widget");document.body.appendChild(a);const i=a.attachShadow({mode:"open"}),o=document.createElement("link");o.rel="stylesheet",o.href=`${l.replace("#","build/assets")}/mount.css`,i.appendChild(o),o.onload=()=>{const e=document.createElement("div");e.classList.add("TriplomatWidgetContainer"),e.addEventListener("click",t=>{t.target===e&&a.remove()}),i.appendChild(e);const n=document.createElement("iframe"),c=`${l}/${d}?lightMode=${u}`,r=new URL(c).origin,m=()=>{try{console.log("sendMessage called"),console.log("Target origin:",r),console.log("Iframe src:",n.src),n.contentWindow.postMessage(s,r),console.log("Message posted successfully")}catch(t){console.error("Failed to post message:",t)}};console.log("Setting up iframe load listeners");const g=t=>{t.data?.type==="WIDGET_READY"&&(console.log("Widget ready signal received, sending data"),window.removeEventListener("message",g),m())};window.addEventListener("message",g),setTimeout(()=>{console.log("Fallback: Sending message after timeout"),m()},2e3),n.src=c,e.appendChild(n),console.log("Widget mounted")}}window.TriplomatWidget={mount:p},console.log("Mount script loaded")})();
