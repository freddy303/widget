(function(){if(!customElements.get("triplomat-widget")){class n extends HTMLElement{constructor(){super()}}customElements.define("triplomat-widget",n)}function g(n,{theme:s="standard",lightMode:m=!0,url:l="http://127.0.0.1:8000/widget"}={}){const a=document.createElement("triplomat-widget");document.body.appendChild(a);const c=a.attachShadow({mode:"open"}),o=document.createElement("link");o.rel="stylesheet",o.href=`${l.replace("#","build/assets")}/mount.css`,c.appendChild(o),o.onload=()=>{const t=document.createElement("div");t.classList.add("TriplomatWidgetContainer"),t.addEventListener("click",d=>{d.target===t&&a.remove()}),c.appendChild(t);const e=document.createElement("iframe"),i=new URL(`${l}/${s}`).origin,r=()=>{try{console.log("sendMessage called"),console.log("Target origin:",i),console.log("Iframe src:",e.src),console.log("contentWindow:",e.contentWindow),e.contentWindow.postMessage(n,i),console.log("Message posted successfully")}catch(d){console.error("Failed to post message:",d)}};console.log("Setting up iframe load listeners"),e.addEventListener("load",()=>{console.log("load event fired"),r()}),e.onreadystatechange=()=>{console.log("readystatechange:",e.readyState),e.readyState==="complete"&&r()},e.src=`${l}/${s}?lightMode=${m}`,t.appendChild(e),console.log("Widget mounted")}}window.TriplomatWidget={mount:g},console.log("Mount script loaded")})();
