(function(){if(!customElements.get("triplomat-widget")){class n extends HTMLElement{constructor(){super()}}customElements.define("triplomat-widget",n)}function g(n,{theme:d="standard",lightMode:p=!0,url:i="http://127.0.0.1:8000/widget"}={}){const s=document.createElement("triplomat-widget");document.body.appendChild(s);const l=s.attachShadow({mode:"open"}),o=document.createElement("link");o.rel="stylesheet",o.href=`${i.replace("#","build/assets")}/mount.css`,l.appendChild(o),o.onload=()=>{const e=document.createElement("div");e.classList.add("TriplomatWidgetContainer"),e.addEventListener("click",t=>{t.target===e&&s.remove()}),l.appendChild(e);const a=document.createElement("iframe"),c=`${i}/${d}?lightMode=${p}`,u=new URL(c).origin,r=()=>{try{a.contentWindow.postMessage(n,u),console.log("Message posted successfully")}catch(t){console.error("Failed to post message:",t)}},w=setTimeout(()=>{console.log("Fallback: Sending message after timeout"),r()},2e3),m=t=>{t.data?.type==="WIDGET_READY"&&(console.log("Widget ready signal received, sending data"),window.removeEventListener("message",m),clearTimeout(w),r())};window.addEventListener("message",m),a.src=c,e.appendChild(a),console.log("Widget mounted")}}window.TriplomatWidget={mount:g},console.log("Mount script loaded")})();
